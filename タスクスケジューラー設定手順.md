# タスクスケジューラー設定手順

## 🎯 概要
ApexOne Status Checkerを毎日10時に自動実行するようにタスクスケジューラーに登録します。

## 🚀 自動設定（推奨）

### 方法1: PowerShellスクリプト実行
1. **PowerShellを管理者として実行**
   - Windowsキー + X → "Windows PowerShell (管理者)"

2. **スクリプトを実行**
   ```powershell
   Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
   cd "C:\Users\1040120\ApexOne_status_checker"
   .\setup_task_scheduler.ps1
   ```

### 方法2: バッチファイル実行
1. **コマンドプロンプトを管理者として実行**
   - Windowsキー + X → "コマンドプロンプト (管理者)"

2. **スクリプトを実行**
   ```cmd
   cd "C:\Users\1040120\ApexOne_status_checker"
   powershell -ExecutionPolicy Bypass -File setup_task_scheduler.ps1
   ```

## 🔧 手動設定

### 手順1: タスクスケジューラーを開く
1. Windowsキー + R → `taskschd.msc` と入力
2. Enterキーを押す

### 手順2: 基本タスクの作成
1. 右側の「基本タスクの作成」をクリック
2. タスク名: `ApexOne Status Checker`
3. 説明: `毎日10時にApexOne Status Checkerを実行`
4. 「次へ」をクリック

### 手順3: トリガーの設定
1. 「毎日」を選択
2. 「次へ」をクリック
3. 開始: `10:00:00`
4. 「次へ」をクリック

### 手順4: アクションの設定
1. 「プログラムの開始」を選択
2. 「次へ」をクリック
3. プログラム/スクリプト: `C:\Users\1040120\ApexOne_status_checker\run_status_checker.bat`
4. 開始: `C:\Users\1040120\ApexOne_status_checker`
5. 「次へ」をクリック

### 手順5: 完了
1. 設定内容を確認
2. 「完了」をクリック

## ⚙️ 詳細設定の調整

### 手順1: タスクのプロパティを開く
1. 作成したタスクを右クリック
2. 「プロパティ」を選択

### 手順2: 条件タブの設定
- ✅ **コンピューターをAC電源で使用している場合のみタスクを開始する**: チェックを外す
- ✅ **ネットワーク接続が利用可能な場合のみタスクを開始する**: チェックを入れる

### 手順3: 設定タブの設定
- ✅ **タスクを要求時に実行する**: チェックを入れる
- ✅ **スケジュールされた時刻にタスクを開始できなかった場合、できるだけ早く開始する**: チェックを入れる

## 🔍 動作確認

### 手順1: タスクの手動実行
1. 作成したタスクを右クリック
2. 「実行」を選択
3. 正常に動作することを確認

### 手順2: ログファイルの確認
1. `C:\Users\1040120\ApexOne_status_checker\apexone_status_log.csv` を確認
2. 実行結果が記録されていることを確認

### 手順3: 次回実行時刻の確認
1. タスクのプロパティ → トリガータブ
2. 次回実行時刻が正しく設定されていることを確認

## 🚨 トラブルシューティング

### 問題1: タスクが実行されない
**原因**: 権限不足、パスが間違っている
**解決策**: 
- PowerShellを管理者として実行
- パスが正しいか確認

### 問題2: エラーが発生する
**原因**: Python環境、依存関係の問題
**解決策**:
- バッチファイルを手動実行してエラーを確認
- ログファイルで詳細を確認

### 問題3: 時刻がずれる
**原因**: タイムゾーンの設定
**解決策**:
- システムのタイムゾーン設定を確認
- タスクの時刻設定を再調整

## 📋 設定完了後の動作

### 毎日の自動実行
- **時刻**: 毎日10:00
- **実行内容**: ApexOne Status Checkerの自動実行
- **ログ記録**: 実行結果をCSVファイルに記録
- **ファイル保存**: スクリーンショット、HTML、テキストファイル

### ログファイルの蓄積
- 実行日時、結果、詳細が記録される
- 成功率、実行回数などの統計情報が蓄積される
- 問題発生時の追跡が可能

## 🎉 完了

これで、ApexOne Status Checkerが毎日10時に自動実行されるようになります！
